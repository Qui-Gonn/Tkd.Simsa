@using Simsa.Ui.Components;

<EditableWraper @ref="EditableWrapperRef"
                TItem="EventEditItem">
    <OverviewTemplate>
        <h6 class="mud-typography mud-typography-h6">Manage Events</h6>
        <MudDataGrid @ref="GridRef"
                     T="EventEditItem"
                     CommittedItemChanges="CommittedItemChangesAsync"
                     EditMode="DataGridEditMode.Form"
                     Hover="true"
                     Items="AllEvents"
                     ReadOnly="false">
            <ToolBarContent>
                <MudButton OnClick="AddNewEventAsync"
                           Size="@Size.Small"
                           StartIcon="@Icons.Material.Filled.Add">
                    Add
                </MudButton>
            </ToolBarContent>
            <Columns>
                <PropertyColumn Property="e => e.Source.Name"/>
                <PropertyColumn Format="D"
                                Property="e => e.StartDate"
                                Title="Start Date">
                    <EditTemplate>
                        <MudDatePicker @bind-Date="context.Item.StartDate"
                                       Label="Start Date"
                                       Variant="Variant.Outlined"
                                       Required="true"/>
                    </EditTemplate>
                </PropertyColumn>
                <PropertyColumn Property="e => e.Source.Description"/>
                <TemplateColumn CellClass="d-flex justify-end"
                                Title="Actions">
                    <CellTemplate>
                        <MudIconButton Icon="@Icons.Material.Filled.Edit"
                                       OnClick="() => EditableWrapperRef.StartEditMode(context.Item)"
                                       Size="@Size.Small"/>
                        <MudIconButton Icon="@Icons.Material.Filled.Delete"
                                       OnClick="() => DeleteEventAsync(context.Item)"
                                       Size="@Size.Small"/>
                    </CellTemplate>
                </TemplateColumn>
            </Columns>
        </MudDataGrid>
    </OverviewTemplate>
    <EditModeTemplate>
        <EventDetailsForm Event="context"/>
    </EditModeTemplate>
</EditableWraper>