@using Tkd.Simsa.Domain.EventManagement
@using Tkd.Simsa.Domain.PersonManagement
@attribute [Route($"{RouteConstants.EventManagement}/add")]
@attribute [Route($"{RouteConstants.EventManagement}/edit/{{ItemId:guid}}")]

<DefaultEditComponent TItem="Event"
                      TEditItem="EventEditItem"
                      ItemType="ItemTypes.Event"
                      ItemId="ItemId">
    <FormContent>
        <MudTextField Label="Id"
                      ReadOnly="true"
                      Value="@context.Source.Id"
                      Variant="ThemeProvider.Variant" />
        <MudTextField Label="Name"
                      Required
                      @bind-Value="@context.Name"
                      Variant="ThemeProvider.Variant" />
        <MudDatePicker Label="Start Date"
                       Required
                       @bind-Date="@context.StartDate"
                       Variant="ThemeProvider.Variant" />
        <MudTextField AutoGrow="true"
                      Label="Description"
                      Lines="3"
                      MaxLines="7"
                      @bind-Value="@context.Description"
                      Variant="ThemeProvider.Variant" />

        @* <MudText Typo="Typo.h5" GutterBottom="true">Manage @ItemType.Name.Plural</MudText> *@
        <MudDataGrid T="Participant"
                     FixedHeader="true"
                     Height="100%"
                     Hover="true"
                     Items="@context.Source.ParticipationData.Participants">
            <ToolBarContent>
                @* <MudButton OnClick="Add" *@
                @*            StartIcon="@Icons.Material.Filled.Add"> *@
                @*     New *@
                @* </MudButton> *@
            </ToolBarContent>
            <Columns>
                <PropertyColumn T="Participant"
                                TProperty="string"
                                Property="item => item.PersonSnapshot.Name.FirstName"
                                Title="First Name" />
                <PropertyColumn T="Participant"
                                TProperty="string"
                                Property="item => item.PersonSnapshot.Name.LastName"
                                Title="Last Name" />
                <PropertyColumn T="Participant"
                                TProperty="DateOnly"
                                Format="D"
                                Property="item => item.PersonSnapshot.DateOfBirth.Date"
                                Title="Date of Birth" />
                <PropertyColumn T="Participant"
                                TProperty="Gender"
                                Property="item => item.PersonSnapshot.Gender" />
            </Columns>
        </MudDataGrid>

    </FormContent>
</DefaultEditComponent>

@code{

    [Parameter]
    public Guid? ItemId { get; set; }

    [CascadingParameter]
    public ThemeProvider ThemeProvider { get; set; } = default!;

}